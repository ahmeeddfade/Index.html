<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ElAhmad TV - ğŸ“º</title>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
* { 
  box-sizing: border-box; 
  margin: 0;
  padding: 0;
}

html, body {
  width: 100%;
  height: 100%;
  background: #000;
  overflow: hidden;
  font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
  color: #fff;
}

/* ===== Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ ===== */
#splash {
  position: fixed;
  inset: 0;
  background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  opacity: 1;
  transition: opacity 1s cubic-bezier(0.4, 0, 0.2, 1);
}

#splash.fade-out {
  opacity: 0;
}

.splash-box {
  text-align: center;
  animation: float 3s ease-in-out infinite;
}

.splash-box h1 {
  font-size: 3.5rem;
  margin-bottom: 1rem;
  background: linear-gradient(90deg, #ff6f00, #ffbb00);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  letter-spacing: 1px;
  font-weight: 700;
}

.splash-box p {
  font-size: 1.3rem;
  opacity: 0.8;
  margin-top: 0.5rem;
  animation: pulse 2s infinite;
}

@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
}

@keyframes pulse {
  0%, 100% { opacity: 0.8; }
  50% { opacity: 1; }
}

/* ===== Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ===== */
video {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: contain;
  background: #000;
  z-index: 1;
}

/* ===== Ø§Ù„Ù†Øµ Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯ÙŠ ===== */
.hint {
  position: fixed;
  top: 24px;
  left: 40px; /* ØªØºÙŠÙŠØ± Ù…Ù† right Ø¥Ù„Ù‰ left Ù„Ø£Ù†Ù†Ø§ Ø§Ø³ØªØ®Ø¯Ù…Ù†Ø§ dir="rtl" */
  font-size: 14px;
  opacity: 0.6;
  transition: opacity 0.3s ease;
  z-index: 4;
  background: rgba(0, 0, 0, 0.5);
  padding: 8px 16px;
  border-radius: 20px;
  backdrop-filter: blur(4px);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.overlay.hide ~ .hint {
  opacity: 0;
  pointer-events: none;
}

/* ===== Overlay Ø§Ù„Ù‚Ù†ÙˆØ§Øª ===== */
.overlay {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  padding: 8px 26px; /* âœ… ØªÙ… ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ */
  background: linear-gradient(to top, 
    rgba(0, 0, 0, 0.95) 0%, 
    rgba(0, 0, 0, 0.85) 40%, 
    transparent 100%);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 3;
  display: flex;
  justify-content: center;
}

.overlay.hide {
  opacity: 0;
  transform: translateY(20px);
  pointer-events: none;
}

/* ===== Ø§Ù„Ù‚Ù†ÙˆØ§Øª ===== */
.channels {
  display: flex;
  gap: 20px;
  align-items: center;
  justify-content: center;
  max-width: 95%;
  overflow-x: auto;
  padding: 8px 0;
  scrollbar-width: none; /* Firefox */
}

.channels::-webkit-scrollbar {
  display: none; /* Chrome, Safari */
}

/* ===== ÙƒØ±ÙˆØª Ø§Ù„Ù‚Ù†ÙˆØ§Øª ===== */
.card {
  width: 220px; /* âœ… ØªÙ… ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶ */
  padding: 14px; /* âœ… ØªÙ… ØªÙ‚Ù„ÙŠÙ„ padding */
  border-radius: 18px; /* âœ… ØªÙ… ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø²ÙˆØ§ÙŠØ§ Ù‚Ù„ÙŠÙ„Ø§Ù‹ */
  background: rgba(255, 255, 255, 0.07);
  text-align: center;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  flex-shrink: 0;
  cursor: pointer;
  border: 1px solid rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(10px);
}

.card:hover {
  background: rgba(255, 255, 255, 0.1);
  transform: translateY(-4px);
}

.card img {
  width: 100%;
  height: 70px; /* âœ… ØªÙ… ØªÙ‚Ù„ÙŠÙ„ Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„ØµÙˆØ±Ø© */
  object-fit: contain;
  filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
}

.card span {
  display: block;
  margin-top: 8px; /* âœ… ØªÙ… ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© */
  font-size: 18px; /* âœ… ØªÙ… ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„Ø®Ø· Ù‚Ù„ÙŠÙ„Ø§Ù‹ */
  font-weight: 500;
  color: rgba(255, 255, 255, 0.9);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ===== Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ù†Ø´Ø·Ø© ===== */
.card.active {
  background: linear-gradient(135deg, #ff6f00 0%, #ff8f00 100%);
  transform: scale(1.18);
  box-shadow: 
    0 12px 40px rgba(255, 111, 0, 0.4),
    0 0 0 2px rgba(255, 255, 255, 0.1);
  z-index: 2;
}

.card.active span {
  color: white;
  font-weight: 600;
}

/* ===== Ù…Ø¤Ø´Ø± Ø§Ù„ØªÙ…Ø±ÙŠØ± ===== */
.scroll-indicator {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: rgba(255, 111, 0, 0.3);
  transform-origin: 0 0;
  animation: scroll-progress 5s linear;
}

@keyframes scroll-progress {
  0% { transform: scaleX(0); }
  100% { transform: scaleX(1); }
}

/* ===== ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© ===== */
@media (min-width: 1600px) {
  .card {
    width: 240px;
    padding: 16px;
  }
  
  .card img {
    height: 80px;
  }
}

/* ===== Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ ===== */
.loading {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 100;
  background: rgba(0, 0, 0, 0.7);
  padding: 20px 30px;
  border-radius: 12px;
  display: none;
}

.loading.show {
  display: block;
}

.loading-spinner {
  width: 40px;
  height: 40px;
  border: 3px solid rgba(255, 255, 255, 0.1);
  border-top: 3px solid #ff6f00;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 10px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>
</head>

<body>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ -->
<div id="splash">
  <div class="splash-box">
    <h1>ElAhmad TV</h1>
    <p>Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ Ù…Ø´Ø§Ù‡Ø¯Ø© Ù…Ù…ØªØ¹Ø© ğŸ“ºâœ¨</p>
    <div class="loading-spinner" style="margin-top: 20px;"></div>
  </div>
</div>

<!-- Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
<div class="loading" id="loading">
  <div class="loading-spinner"></div>
  <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†Ø§Ø©...</p>
</div>

<!-- Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
<video id="player" autoplay playsinline></video>

<!-- Ø§Ù„Ù†Øµ Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯ÙŠ -->
<div class="hint">â¬…ï¸â¡ï¸ ØªØºÙŠÙŠØ± Ø§Ù„Ù‚Ù†Ø§Ø© | â¬†ï¸ Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</div>

<!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚Ù†ÙˆØ§Øª -->
<div class="overlay hide" id="overlay">
  <div class="scroll-indicator"></div>
  <div class="channels" id="channels"></div>
</div>

<script>
// Ø¹Ù†Ø§ØµØ± DOM
const video = document.getElementById("player");
const overlay = document.getElementById("overlay");
const list = document.getElementById("channels");
const splash = document.getElementById("splash");
const loading = document.getElementById("loading");

// Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
let hls = null;
let index = 0;
let hideTimer = null;
let channels = [];
let splashRemoved = false;
const CHANNELS_URL = "channels.json";

/* ===== ØªØ´ØºÙŠÙ„ Ø§Ù„Ù‚Ù†Ø§Ø© ===== */
function play(url, showLoading = true) {
  if (showLoading) {
    loading.classList.add('show');
  }
  
  if (hls) {
    hls.destroy();
    hls = null;
  }

  if (Hls.isSupported()) {
    hls = new Hls({
      enableWorker: true,
      lowLatencyMode: true,
      backBufferLength: 90
    });
    
    hls.on(Hls.Events.MANIFEST_PARSED, () => {
      loading.classList.remove('show');
    });
    
    hls.on(Hls.Events.ERROR, (event, data) => {
      console.error('HLS error:', data);
      if (data.fatal) {
        switch(data.type) {
          case Hls.ErrorTypes.NETWORK_ERROR:
            hls.startLoad();
            break;
          case Hls.ErrorTypes.MEDIA_ERROR:
            hls.recoverMediaError();
            break;
          default:
            loading.classList.remove('show');
            break;
        }
      }
    });
    
    hls.loadSource(url);
    hls.attachMedia(video);
  } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
    video.src = url;
    loading.classList.remove('show');
  }

  // ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª
  video.muted = false;
  video.volume = 1;
  
  video.play().catch(err => {
    console.log('Auto-play prevented:', err);
    loading.classList.remove('show');
  });
  
  // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø¨Ø¹Ø¯ Ø£ÙˆÙ„ ØªØ´ØºÙŠÙ„
  if (!splashRemoved) {
    setTimeout(() => {
      splash.classList.add('fade-out');
      setTimeout(() => {
        splash.style.display = 'none';
        splashRemoved = true;
      }, 800);
    }, 1200);
  }
}

/* ===== Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ===== */
function showOverlay() {
  overlay.classList.remove('hide');
  clearTimeout(hideTimer);
  
  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ù…Ø¤Ø´Ø± Ø§Ù„ØªÙ…Ø±ÙŠØ±
  const indicator = document.querySelector('.scroll-indicator');
  indicator.style.animation = 'none';
  setTimeout(() => {
    indicator.style.animation = 'scroll-progress 5s linear';
  }, 10);
  
  hideTimer = setTimeout(() => {
    overlay.classList.add('hide');
  }, 5000);
}

/* ===== Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ù†Ø§Ø© ===== */
function focus() {
  // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ±ÙƒÙŠØ² Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒØ±ÙˆØª
  document.querySelectorAll('.card').forEach(card => {
    card.classList.remove('active');
  });
  
  // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ±ÙƒÙŠØ² Ù„Ù„ÙƒØ§Ø±Øª Ø§Ù„Ø­Ø§Ù„ÙŠ
  const card = list.children[index];
  if (card) {
    card.classList.add('active');
    
    // ØªÙ…Ø±ÙŠØ± Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØµÙ Ø¥Ù† Ø£Ù…ÙƒÙ†
    card.scrollIntoView({
      behavior: 'smooth',
      block: 'nearest',
      inline: 'center'
    });
    
    play(channels[index].stream);
  }
}

/* ===== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª ===== */
function loadChannels() {
  fetch(CHANNELS_URL)
    .then(response => {
      if (!response.ok) {
        throw new Error(`Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      channels = data.channels;
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø¥Ù„Ù‰ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
      channels.forEach((channel, i) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.tabIndex = 0;
        card.setAttribute('role', 'button');
        card.setAttribute('aria-label', `Ù‚Ù†Ø§Ø© ${channel.name}`);
        
        card.innerHTML = `
          <img src="${channel.logo}" alt="${channel.name}" loading="lazy">
          <span>${channel.name}</span>
        `;
        
        // Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ù†Ø§Ø©
        card.addEventListener('click', () => {
          index = i;
          focus();
          showOverlay();
        });
        
        list.appendChild(card);
      });
      
      // Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
      focus();
      
      // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù…Ø¤Ù‚ØªØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
      showOverlay();
    })
    .catch(error => {
      console.error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª:', error);
      // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£
      list.innerHTML = `
        <div style="text-align: center; padding: 40px;">
          <h3>âš ï¸ ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª</h3>
          <p>ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø£Ùˆ Ù…Ù„Ù channels.json</p>
        </div>
      `;
    });
}

/* ===== Ø§Ù„ØªØ­ÙƒÙ… Ø¹Ù† Ø¨Ø¹Ø¯ (Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­) ===== */
document.addEventListener('keydown', (e) => {
  if (!channels.length) return;
  
  e.preventDefault();
  
  switch(e.key) {
    case 'ArrowRight':
    case 'ArrowLeft':
      showOverlay();
      if (e.key === 'ArrowRight') {
        index = (index + 1) % channels.length;
      } else {
        index = (index - 1 + channels.length) % channels.length;
      }
      focus();
      break;
      
    case 'ArrowUp':
    case 'ArrowDown':
      if (overlay.classList.contains('hide')) {
        showOverlay();
      } else {
        overlay.classList.add('hide');
      }
      break;
      
    case ' ': // Spacebar
      if (video.paused) {
        video.play();
      } else {
        video.pause();
      }
      break;
      
    case 'm': // Mute toggle
    case 'M':
      video.muted = !video.muted;
      break;
  }
});

/* ===== Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù„Ù…Ø³ ===== */
let startX = 0;
let startTime = 0;

document.addEventListener('touchstart', (e) => {
  startX = e.touches[0].clientX;
  startTime = Date.now();
  showOverlay();
});

document.addEventListener('touchend', (e) => {
  const endX = e.changedTouches[0].clientX;
  const endTime = Date.now();
  const diffX = endX - startX;
  const diffTime = endTime - startTime;
  
  // ØªØ£ÙƒÙŠØ¯ Ø£Ù† Ø§Ù„Ø­Ø±ÙƒØ© Ø³Ø±ÙŠØ¹Ø© ÙˆÙ„ÙŠØ³Øª ØªÙ…Ø±ÙŠØ± Ø¹Ø§Ø¯ÙŠ
  if (diffTime < 300 && Math.abs(diffX) > 60) {
    if (diffX < 0) { // Ø³Ø­Ø¨ Ù„Ù„ÙŠØ³Ø§Ø±
      index = (index + 1) % channels.length;
    } else { // Ø³Ø­Ø¨ Ù„Ù„ÙŠÙ…ÙŠÙ†
      index = (index - 1 + channels.length) % channels.length;
    }
    focus();
  }
});

/* ===== Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù…Ø§ÙˆØ³ ===== */
let mouseTimer = null;
document.addEventListener('mousemove', () => {
  if (overlay.classList.contains('hide')) {
    showOverlay();
  }
  
  clearTimeout(mouseTimer);
  mouseTimer = setTimeout(() => {
    if (!overlay.classList.contains('hide')) {
      overlay.classList.add('hide');
    }
  }, 3000);
});

/* ===== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ===== */
function init() {
  loadChannels();
  
  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¤Ø´Ø± Ø§Ù„ØªÙ…Ø±ÙŠØ±
  const indicator = document.createElement('div');
  indicator.className = 'scroll-indicator';
  overlay.appendChild(indicator);
  
  // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… ØªØ´ØºÙŠÙ„ Ù‚Ù†Ø§Ø©
  setTimeout(() => {
    if (!splashRemoved) {
      splash.classList.add('fade-out');
      setTimeout(() => {
        splash.style.display = 'none';
        splashRemoved = true;
      }, 800);
    }
  }, 5000);
}

// Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
window.addEventListener('DOMContentLoaded', init);

// ÙƒÙˆØ¯ Ø§Ø­ØªÙŠØ§Ø·ÙŠ ÙÙŠ Ø­Ø§Ù„Ø© ÙØ´Ù„ HLS
video.addEventListener('error', () => {
  loading.classList.remove('show');
  console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ');
});
</script>

</body>
</html>
